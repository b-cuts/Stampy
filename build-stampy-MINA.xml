
<project name="stampy-MINA-client-server-RI" basedir="." default="release.stampy.MINA.client.server.RI" xmlns:ivy="antlib:org.apache.ivy.ant">
	
	<path id="stampy.classpath">
		<fileset dir="${basedir}/lib">
			<include name="**/*.jar"/>
		</fileset>
		<fileset dir="${basedir}/build/stampy-core">
			<include name="stampy-core.jar"/>
		</fileset>
		<fileset dir="${basedir}/build/stampy-client-server">
			<include name="stampy-client-server.jar"/>
		</fileset>
	</path>

	<target name="release.stampy.MINA.client.server.RI" depends="jar.stampy.MINA.client.server.RI.src, jar.stampy.MINA.client.server.RI.javadoc, jar.stampy.MINA.client.server.RI" />
	
	<target name="compile.stampy.MINA.client.server.RI">
		<javac target="1.5" source="1.5" srcdir="${basedir}/mina" debug="true" destdir="${basedir}/build/bin">
			<classpath refid="stampy.classpath" />
		</javac>		
	</target>
	
	<target name="create.overview">
		<copyfile 
			forceoverwrite="true" 
			dest="${basedir}/build/tmp/Overview-stampy-MINA.html" 
			src="${basedir}/html/Overview-stampy-MINA.html"/>
		
		<loadfile property="stampy-core-fragment" srcfile="${basedir}/html/fragments/stampy-core.txt" />
		<loadfile property="stampy-client-server-fragment" srcfile="${basedir}/html/fragments/stampy-client-server.txt" />
		<loadfile property="stampy-MINA-fragment" srcfile="${basedir}/html/fragments/stampy-MINA.txt" />
		
		<replace 
			file="${basedir}/build/tmp/Overview-stampy-MINA.html" 
			token="$stampy-core-fragment" value="${stampy-core-fragment}" />
		<replace 
			file="${basedir}/build/tmp/Overview-stampy-MINA.html" 
			token="$stampy-client-server-fragment" 
			value="${stampy-client-server-fragment}" />
		<replace 
			file="${basedir}/build/tmp/Overview-stampy-MINA.html" 
			token="$stampy-MINA-fragment" 
			value="${stampy-MINA-fragment}" />
		
		<replace file="${basedir}/build/tmp/Overview-stampy-MINA.html" token="$version" value="${version}" />
		<replace file="${basedir}/build/tmp/Overview-stampy-MINA.html" token="$date" value="${date}" />
	</target>

	<target name="javadoc.stampy.MINA.client.server.RI" depends="compile.stampy.MINA.client.server.RI, create.overview">
		<javadoc 
			overview="${basedir}/build/tmp/Overview-stampy-MINA.html" 
			classpathref="stampy.classpath" 
			sourcepath="${basedir}/src;${basedir}/mina;${basedir}/client-server" 
			packagenames="asia.stampy.*" 
			destdir="${basedir}/build/javadoc">
		</javadoc>
	</target>
	
	<target name="jar.stampy.MINA.client.server.RI" depends="compile.stampy.MINA.client.server.RI">
		<jar destfile="${basedir}/build/stampy-MINA-client-server-RI/stampy-MINA-client-server-RI.jar" basedir="${basedir}/build/bin">
			<manifest id="stampy.MINA.client.server.RI.manifest">
				<attribute name="Built-By" value="${jar.built.by}"/>
				<attribute name="Email-Address" value="${jar.email.address}"/>
				<attribute name="Project-Website" value="${jar.project.website}"/>
				<attribute name="Release-Number" value="${version}"/>
				<attribute name="Release-Description" value="${releaseDescription}"/>
			</manifest>
		</jar>
	</target>
	
	<target name="jar.stampy.MINA.client.server.RI.javadoc" depends="javadoc.stampy.MINA.client.server.RI">
		<jar destfile="${basedir}/build/stampy-MINA-client-server-RI/stampy-MINA-client-server-RI-javadoc.jar" basedir="${basedir}/build/javadoc">
			<manifest id="stampy.MINA.client.server.RI.manifest">
				<attribute name="Built-By" value="${jar.built.by}"/>
				<attribute name="Email-Address" value="${jar.email.address}"/>
				<attribute name="Project-Website" value="${jar.project.website}"/>
				<attribute name="Release-Number" value="${version}"/>
				<attribute name="Release-Description" value="${releaseDescription}"/>
			</manifest>
		</jar>
	</target>
	
	<target name="jar.stampy.MINA.client.server.RI.src">
		<jar destfile="${basedir}/build/stampy-MINA-client-server-RI/stampy-MINA-client-server-RI-src.jar" basedir="${basedir}/mina">
			<manifest id="stampy.MINA.client.server.RI.manifest">
				<attribute name="Built-By" value="${jar.built.by}"/>
				<attribute name="Email-Address" value="${jar.email.address}"/>
				<attribute name="Project-Website" value="${jar.project.website}"/>
				<attribute name="Release-Number" value="${version}"/>
				<attribute name="Release-Description" value="${releaseDescription}"/>
			</manifest>
		</jar>
	</target>

</project>